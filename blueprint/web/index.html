<!DOCTYPE html>
<html lang="en">
<head>
<script>
  MathJax = { 
    tex: {
		    inlineMath: [['$','$'], ['\\(','\\)']]
	} }
</script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>
<meta name="generator" content="plasTeX" />
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Branch Number Formalization</title>
<link rel="stylesheet" href="styles/theme-white.css" />
<link rel="stylesheet" href="styles/amsthm.css" />
<link rel="stylesheet" href="styles/showmore.css" />
<link rel="stylesheet" href="styles/blueprint.css" />
<link rel="stylesheet" href="styles/extra_styles.css" />
</head>

<body>

<div class="wrapper">

<div class="content">
<div class="content-wrapper">


<div class="main-text">
 <div class="titlepage">
<h1>Branch Number Formalization</h1>
<p class="authors">
<span class="author">Axiomatic AI</span>
</p>
</div><h1 id="a0000000002">Introduction</h1>
<p>This blueprint formalizes Theorem 1 from <a href ="https://arxiv.org/pdf/2405.07007"><i class="itshape">A New Algorithm for Computing Branch Number of Non-Singular Matrices over Finite Fields</i></a>. We provide a verified proof that the branch number of an invertible matrix can be computed using an alternate, but equivalent definition. The branch number measures how well a linear transformation spreads information, which is essential for designing secure cryptographic systems. </p>
<h1 id="a0000000003">Preliminaries</h1>
<p>Let \(\mathbb {F}_q\) denote a finite field of order \(q\), where \(q = p^m\) for some prime \(p\) and positive integer \(m.\) We denote by \(\mathbb {F}_q^n\) the set of vectors of length \(n\) with entries from \(\mathbb {F}_q\). </p>
<div class="definition_thmwrapper theorem-style-plain" id="def:hamming_weight">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">1</span>
    <span class="definition_thmtitle">Hamming Weight</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="index.html#def:hamming_weight">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="/find/#doc/wH" class="lean_decl">wH</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>   The Hamming weight of a vector \(x = (x_1, \ldots , x_n) \in \mathbb {F}_q^n\), denoted by \(w_h(x)\), is the total number of non-zero components in \(x\): </p>
<div class="displaymath" id="a0000000004">
  \begin{equation*}  w_h(x) = |\{ i \in \{ 1, 2, \ldots , n\}  : x_i \neq 0\} |. \end{equation*}
</div>

  </div>
</div>
<div class="definition_thmwrapper theorem-style-plain" id="def:helper_h">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">2</span>
    <span class="definition_thmtitle">Branch Function</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="index.html#def:helper_h">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="index.html#def:hamming_weight">Definition 1</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="/find/#doc/h" class="lean_decl">h</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>    For a matrix \(M\) of order \(n\) over \(\mathbb {F}_q\) and a vector \(x \in \mathbb {F}_q^n\), we define </p>
<div class="displaymath" id="a0000000005">
  \begin{equation*}  h(M,x) = w_h(x) + w_h(Mx). \end{equation*}
</div>

  </div>
</div>
<div class="definition_thmwrapper theorem-style-plain" id="def:diff_branch">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">3</span>
    <span class="definition_thmtitle">Differential Branch Number</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="index.html#def:diff_branch">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="index.html#def:hamming_weight">Definition 1</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="/find/#doc/Branchnumber" class="lean_decl">Branchnumber</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>    The differential branch number \(\mathcal{B}_d(M)\) of a matrix \(M\) of order \(n\) over the finite field \(\mathbb {F}_q\) is defined as </p>
<div class="displaymath" id="a0000000006">
  \begin{equation*}  \mathcal{B}_d(M) = \min _{x \neq 0} \{ w_h(x) + w_h(Mx)\} . \end{equation*}
</div>

  </div>
</div>
<p>For simplicity, we refer to the differential branch number as the branch number and denote it by \(\mathcal{B}(M)\). </p>
<h1 id="a0000000007">Branch Number Theorem</h1>
<div class="theorem_thmwrapper theorem-style-plain" id="thm:branch_number_main">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">1</span>
    <span class="theorem_thmtitle">Branch Number of Invertible Matrix</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="index.html#thm:branch_number_main">#</a>
    
    <a class="icon proof" href="index.html#a0000000008"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="index.html#lem:weight_partition">Step 1</a></li>
          
          <li><a href="index.html#lem:high_weight_partition">Step 2</a></li>
          
          <li><a href="index.html#lem:high_weight_excluded">Step 3</a></li>
          
          <li><a href="index.html#lem:extra_term">Step 4</a></li>
          
          <li><a href="index.html#lem:matrix_inverse">Step 5</a></li>
          
          <li><a href="index.html#lem:efficient_formula">Step 6</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="/find/#doc/branchnumber_equiv" class="lean_decl">branchnumber_equiv</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  <p>    Let \(M \in M_n(\mathbb {F}_q)\) be an invertible matrix. Then the branch number of \(M\) is given by </p>
<div class="displaymath" id="a0000000009">
  \begin{equation*}  \mathcal{B}(M) = \min \left\{ \min \{ h(M,x), h(M^{-1},x)\}  \mid x \in \mathbb {F}_q^n, 1 \leq w_h(x) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\} . \end{equation*}
</div>

  </div>
</div>
<p>We establish this theorem through a series of intermediate steps. </p>
<p>Recall that for an invertible matrix \(M\) in \(M_n(\mathbb {F}_q)\), where \(n {\gt} 1\), the branch number \(\mathcal{B}(M)\) is given as </p>
<div class="displaymath" id="a0000000010">
  \begin{equation*}  \mathcal{B}(M) = \min \{ h(M,x) \mid x \in \mathbb {F}_q^n, x \neq 0\} . \end{equation*}
</div>
<p>Since \(x \neq 0 \Rightarrow w_h(x) \neq 0\), we may write </p>
<div class="displaymath" id="a0000000011">
  \begin{equation*}  \mathcal{B}(M) = \min \{ h(M,x) \mid x \in \mathbb {F}_q^n, 1 \leq w_h(x) \leq n\} . \end{equation*}
</div>
<p><div class="stepinner_thmwrapper theorem-style-definition" id="lem:weight_partition">
  <div class="stepinner_thmheading">
    <span class="stepinner_thmcaption">
    Step
    </span>
    <span class="stepinner_thmlabel">1</span>
    <span class="stepinner_thmtitle">Weight Partition</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="index.html#lem:weight_partition">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="index.html#def:diff_branch">Definition 3</a></li>
          
          <li><a href="index.html#def:helper_h">Definition 2</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="stepinner_thmcontent">
  <p>    For an invertible matrix \(M \in M_n(\mathbb {F}_q)\), the branch number can be partitioned by vector weight: </p>
<div class="equation" id="<plasTeX.TeXFragment object at 0x11f2956d0>">
<p>
  <div class="equation_content">
    \begin{equation} \label{thm_branch_eqn:1} \begin{aligned}  \mathcal{B}(M) = \min \Bigg\{ & \min \left\{ h(M,x) \mid x \in \mathbb {F}_q^n, 1 \leq w_h(x) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\} ,\\ & \min \left\{ h(M,x) \mid x \in \mathbb {F}_q^n, \left\lfloor \frac{n+1}{2} \right\rfloor {\lt} w_h(x) \leq n\right\} \Bigg\} . \end{aligned} \end{equation}
  </div>
  <span class="equation_label">1</span>
</p>
</div>

  </div>
</div> </p>
<div class="proof_wrapper" id="a0000000012">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▶</span>
  </div>
  <div class="proof_content">
  <p>We partition the set \(\{ 1, \ldots , n\} \) into two parts: \(\{ 1, \ldots , \lfloor (n+1)/2 \rfloor \} \) and \(\{ \lfloor (n+1)/2 \rfloor + 1, \ldots , n\} \), to compute \(\mathcal{B}(M)\) as in (1). </p>

  </div>
</div>
<p><div class="stepinner_thmwrapper theorem-style-definition" id="lem:high_weight_partition">
  <div class="stepinner_thmheading">
    <span class="stepinner_thmcaption">
    Step
    </span>
    <span class="stepinner_thmlabel">2</span>
    <span class="stepinner_thmtitle">Partition High Weight by Image</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="index.html#lem:high_weight_partition">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="index.html#lem:weight_partition">Step 1</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="stepinner_thmcontent">
  <p>    The high-weight term in (1) can be further partitioned by the weight of the image: </p>
<div class="equation" id="<plasTeX.TeXFragment object at 0x11f297950>">
<p>
  <div class="equation_content">
    \begin{equation} \label{thm_branch_eqn:2} \begin{aligned} & \min \left\{ h(M,x) \mid x \in \mathbb {F}_q^n, \left\lfloor \frac{n+1}{2} \right\rfloor {\lt} w_h(x) \leq n\right\} \\ =& \bbox [5pt, #ffe5e5, border: 1px solid #ffcccc]{ \min \Bigg\{  \min \left\{  h(M,x) \mid x \in \mathbb {F}_q^n, \left\lfloor \frac{n+1}{2} \right\rfloor {\lt} w_h(x) \leq n, w_h(Mx) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\} ,}^{\textcolor[RGB]{255,153,153}{\dagger }}\\ & \min \left\{ h(M,x) \mid x \in \mathbb {F}_q^n, \left\lfloor \frac{n+1}{2} \right\rfloor {\lt} w_h(x) \leq n, w_h(Mx) {\gt} \left\lfloor \frac{n+1}{2} \right\rfloor \right\} \Bigg\} . \end{aligned} \end{equation}
  </div>
  <span class="equation_label">2</span>
</p>
</div>

  </div>
</div> </p>
<div class="proof_wrapper" id="a0000000013">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▶</span>
  </div>
  <div class="proof_content">
  <p>We divide the second term on the right-hand side of (1) into cases where \(w_h(Mx) \leq \lfloor (n+1)/2 \rfloor \) and \(w_h(Mx) {\gt} \lfloor (n+1)/2 \rfloor \), which gives us (2) directly. </p>

  </div>
</div>
<p> <span style="color:#FF9999">\(\dagger \)</span> The highlighted term involves taking the minimum over a set that can be empty for certain matrices. See the Verification section (§<a href="index.html#sec:errors">6</a>) for details.  </p>
<p><div class="stepinner_thmwrapper theorem-style-definition" id="lem:high_weight_excluded">
  <div class="stepinner_thmheading">
    <span class="stepinner_thmcaption">
    Step
    </span>
    <span class="stepinner_thmlabel">3</span>
    <span class="stepinner_thmtitle">High Weights Excluded</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="index.html#lem:high_weight_excluded">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="index.html#lem:weight_partition">Step 1</a></li>
          
          <li><a href="index.html#lem:high_weight_partition">Step 2</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="stepinner_thmcontent">
  <p>    Vectors with both high input weight and high output weight do not contribute to the branch number. Specifically, </p>
<div class="equation" id="<plasTeX.TeXFragment object at 0x11f2c8890>">
<p>
  <div class="equation_content">
    \begin{equation} \label{thm_branch_eqn:3} \begin{aligned}  \mathcal{B}(M) = & \min \Bigg\{ \min \left\{ h(M,x) \mid x \in \mathbb {F}_q^n, 1 \leq w_h(x) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\} ,\\ & \min \left\{ h(M,x) \mid x \in \mathbb {F}_q^n, \left\lfloor \frac{n+1}{2} \right\rfloor {\lt} w_h(x) \leq n, w_h(Mx) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\} \Bigg\} . \end{aligned} \end{equation}
  </div>
  <span class="equation_label">3</span>
</p>
</div>

  </div>
</div> </p>
<div class="proof_wrapper" id="a0000000014">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▶</span>
  </div>
  <div class="proof_content">
  <p>From (1) and (2), we have: </p>
<div class="displaymath" id="a0000000015">
  \begin{equation*} \begin{aligned}  \mathcal{B}(M) = \min \Bigg\{ & \min \left\{ h(M,x) \mid x \in \mathbb {F}_q^n, 1 \leq w_h(x) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\} ,\\ & \min \left\{ h(M,x) \mid x \in \mathbb {F}_q^n, \left\lfloor \frac{n+1}{2} \right\rfloor {\lt} w_h(x) \leq n, w_h(Mx) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\} ,\\ & \min \left\{ h(M,x) \mid x \in \mathbb {F}_q^n, \left\lfloor \frac{n+1}{2} \right\rfloor {\lt} w_h(x) \leq n, w_h(Mx) {\gt} \left\lfloor \frac{n+1}{2} \right\rfloor \right\} \Bigg\} . \end{aligned}\end{equation*}
</div>
<p>For the third term, when \(w_h(x) {\gt} \lfloor (n+1)/2 \rfloor \) and \(w_h(Mx) {\gt} \lfloor (n+1)/2 \rfloor \): </p>
<div class="displaymath" id="a0000000016">
  \begin{equation*}  h(M,x) = w_h(x) + w_h(Mx) {\gt} 2\left\lfloor \frac{n+1}{2} \right\rfloor + 1 \geq n + 1. \end{equation*}
</div>
<p> However, we know that the upper bound for \(\mathcal{B}(M)\) is \(n + 1\). Thus, this term will not contribute to the computation of the branch number, giving us (3). </p>

  </div>
</div>
<p><div class="stepinner_thmwrapper theorem-style-definition" id="lem:extra_term">
  <div class="stepinner_thmheading">
    <span class="stepinner_thmcaption">
    Step
    </span>
    <span class="stepinner_thmlabel">4</span>
    <span class="stepinner_thmtitle">Adding Extra Term</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="index.html#lem:extra_term">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="index.html#lem:high_weight_excluded">Step 3</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="stepinner_thmcontent">
  <p>    We can add an extra term without affecting the branch number: </p>
<div class="equation" id="<plasTeX.TeXFragment object at 0x11f2d6e10>">
<p>
  <div class="equation_content">
    \begin{equation} \label{thm_branch_eqn:4} \begin{aligned}  \mathcal{B}(M) = & \min \Bigg\{ \min \left\{ h(M,x) \mid x \in \mathbb {F}_q^n, 1 \leq w_h(x) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\} ,\\ & \min \left\{ h(M,x) \mid x \in \mathbb {F}_q^n, 1 \leq w_h(x) \leq \left\lfloor \frac{n+1}{2} \right\rfloor , w_h(Mx) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\} ,\\ & \min \left\{ h(M,x) \mid x \in \mathbb {F}_q^n, \left\lfloor \frac{n+1}{2} \right\rfloor {\lt} w_h(x) \leq n, w_h(Mx) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\} \Bigg\} . \end{aligned} \end{equation}
  </div>
  <span class="equation_label">4</span>
</p>
</div>

  </div>
</div> </p>
<div class="proof_wrapper" id="a0000000017">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▶</span>
  </div>
  <div class="proof_content">
  <p>We note that </p>
<div class="displaymath" id="a0000000018">
  \begin{equation*} \begin{aligned} & \left\{ h(M,x) \mid x \in \mathbb {F}_q^n, 1 \leq w_h(x) \leq \left\lfloor \frac{n+1}{2} \right\rfloor , w_h(Mx) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\}  \subseteq \\ & \left\{ h(M,x) \mid x \in \mathbb {F}_q^n, 1 \leq w_h(x) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\} . \end{aligned}\end{equation*}
</div>
<p> Therefore, </p>
<div class="displaymath" id="a0000000019">
  \begin{equation*} \begin{aligned} & \min \left\{ h(M,x) \mid x \in \mathbb {F}_q^n, 1 \leq w_h(x) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\}  \leq \\ & \min \left\{ h(M,x) \mid x \in \mathbb {F}_q^n, 1 \leq w_h(x) \leq \left\lfloor \frac{n+1}{2} \right\rfloor , w_h(Mx) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\} . \end{aligned}\end{equation*}
</div>
<p> Since the right-hand side is always greater than or equal to the left-hand side, if we include this extra term in (3), it will not affect the minimum value, giving us (4). </p>

  </div>
</div>
<p><div class="stepinner_thmwrapper theorem-style-definition" id="lem:matrix_inverse">
  <div class="stepinner_thmheading">
    <span class="stepinner_thmcaption">
    Step
    </span>
    <span class="stepinner_thmlabel">5</span>
    <span class="stepinner_thmtitle">Matrix Inverse Substitution</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="index.html#lem:matrix_inverse">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="index.html#lem:extra_term">Step 4</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="stepinner_thmcontent">
  <p>    By merging the last two terms in (4) and substituting \(y = Mx\), we can express the branch number using \(M^{-1}\): </p>
<div class="equation" id="<plasTeX.TeXFragment object at 0x11f43b770>">
<p>
  <div class="equation_content">
    \begin{equation} \label{thm_branch_eqn:5} \begin{aligned}  \mathcal{B}(M) = & \min \Bigg\{ \min \left\{ h(M,x) \mid x \in \mathbb {F}_q^n, 1 \leq w_h(x) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\} ,\\ & \min \left\{ h(M^{-1},y) \mid y \in \mathbb {F}_q^n, 1 \leq w_h(y) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\} \Bigg\} . \end{aligned} \end{equation}
  </div>
  <span class="equation_label">5</span>
</p>
</div>

  </div>
</div> </p>
<div class="proof_wrapper" id="a0000000020">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▶</span>
  </div>
  <div class="proof_content">
  <p>By merging the second and third terms on the right-hand side of (4), we obtain: </p>
<div class="displaymath" id="a0000000021">
  \begin{equation*} \begin{aligned}  \mathcal{B}(M) = & \min \Bigg\{ \min \left\{ h(M,x) \mid x \in \mathbb {F}_q^n, 1 \leq w_h(x) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\} ,\\ & \min \left\{ h(M,x) \mid x \in \mathbb {F}_q^n, 1 \leq w_h(x) \leq n, w_h(Mx) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\} \Bigg\} . \end{aligned}\end{equation*}
</div>
<p>Let \(Mx = y\), then \(x = M^{-1}y\) and \(x \neq 0 \iff y \neq 0 \iff w_h(y) \geq 1\). Then \(h(M,x) = h(M^{-1},y)\) and </p>
<div class="displaymath" id="a0000000022">
  \begin{equation*} \begin{aligned}  \mathcal{B}(M) = & \min \Bigg\{ \min \left\{ h(M,x) \mid x \in \mathbb {F}_q^n, 1 \leq w_h(x) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\} ,\\ & \min \left\{ h(M^{-1},y) \mid x \in \mathbb {F}_q^n, 1 \leq w_h(x) \leq n, 1 \leq w_h(y) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\} \Bigg\} . \end{aligned}\end{equation*}
</div>
<p>We may drop the condition \(1 \leq w_h(x) \leq n\) as this is a trivial condition for \(x \neq 0\). Note that the term \(x \in \mathbb {F}_q^n\) may be replaced by \(y \in \mathbb {F}_q^n\) as the correspondence \(x \to y\) is one-to-one, giving us (5). </p>

  </div>
</div>
<p><div class="stepinner_thmwrapper theorem-style-definition" id="lem:efficient_formula">
  <div class="stepinner_thmheading">
    <span class="stepinner_thmcaption">
    Step
    </span>
    <span class="stepinner_thmlabel">6</span>
    <span class="stepinner_thmtitle">Efficient Formula</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="index.html#lem:efficient_formula">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="index.html#lem:matrix_inverse">Step 5</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="stepinner_thmcontent">
  <p>    The branch number of \(M\) can be computed efficiently as: </p>
<div class="equation" id="sec:errors">
<p>
  <div class="equation_content">
    \begin{equation} \label{thm_branch_eqn:6} \begin{aligned}  \mathcal{B}(M) = \min \left\{ \min \{ h(M,x), h(M^{-1},x)\}  \mid x \in \mathbb {F}_q^n, 1 \leq w_h(x) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\} . \end{aligned} \end{equation}
  </div>
  <span class="equation_label">6</span>
</p>
</div>

  </div>
</div> </p>
<div class="proof_wrapper" id="a0000000008">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▶</span>
  </div>
  <div class="proof_content">
  <p>From (5), we may rename \(y\) to \(x\) to obtain: </p>
<div class="displaymath" id="a0000000023">
  \begin{equation*} \begin{aligned}  \mathcal{B}(M) = & \min \Bigg\{ \min \left\{ h(M,x) \mid x \in \mathbb {F}_q^n, 1 \leq w_h(x) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\} ,\\ & \min \left\{ h(M^{-1},x) \mid x \in \mathbb {F}_q^n, 1 \leq w_h(x) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\} \Bigg\} . \end{aligned}\end{equation*}
</div>
<p>Or, equivalently, we obtain (6). </p>

  </div>
</div>
<p>This completes the proof of Theorem&#160;<a href="index.html#thm:branch_number_main">1</a>. </p>
<h1 id="a0000000024">Verification</h1>

<p>In the formalization of Step <a href="index.html#lem:high_weight_partition">2</a>, the proof takes the minimum over a set of vectors. To take this minimum, we need to show that the set is nonempty. However, the set </p>
<div class="displaymath" id="a0000000025">
  \[  \left\{ x \in \mathbb {F}_q^n \mid \left\lfloor \frac{n+1}{2} \right\rfloor {\lt} w_h(x) \leq n, w_h(Mx) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\}   \]
</div>
<p> can be empty for some matrices. Specifically, when \(M = I\) (the identity matrix), we have \(w_h(Mx) = w_h(Ix) = w_h(x)\), so the set becomes </p>
<div class="displaymath" id="a0000000026">
  \[  \left\{ x \in \mathbb {F}_q^n \mid \left\lfloor \frac{n+1}{2} \right\rfloor {\lt} w_h(x) \leq n, w_h(x) \leq \left\lfloor \frac{n+1}{2} \right\rfloor \right\}  = \emptyset  \]
</div>
<p> which is empty due to the contradictory conditions \(w_h(x) \leq \left\lfloor \frac{n+1}{2} \right\rfloor {\lt} w_h(x)\). This issue corresponds to the <span class="ttfamily">sorry</span> on line 1606 in . </p>
<p>Despite the issue in this intermediate step, the final result in Theorem&#160;<a href="index.html#thm:branch_number_main">1</a> remains valid.  </p>

</div> <!--main-text -->
</div> <!-- content-wrapper -->
</div> <!-- content -->
</div> <!-- wrapper -->

<nav class="prev_up_next">
  <svg  id="showmore-minus" class="icon icon-eye-minus showmore"><use xlink:href="symbol-defs.svg#icon-eye-minus"></use></svg>

  <svg  id="showmore-plus" class="icon icon-eye-plus showmore"><use xlink:href="symbol-defs.svg#icon-eye-plus"></use></svg>

</nav>

<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/plastex.js"></script>
<script type="text/javascript" src="js/svgxuse.js"></script>
<script type="text/javascript" src="js/js.cookie.min.js"></script>
<script type="text/javascript" src="js/showmore.js"></script>
</body>
</html>